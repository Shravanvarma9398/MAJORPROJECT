<% layout('layouts/boilerplate') %>
<script>
  const mapToken = "<%= process.env.MAP_TOKEN %>";
  const listing = <%- JSON.stringify(listing) %>;
</script>

<div class="row mt-3">
  <div class="col-8 offset-2">
    <b><%= listing.title %></b><br>
  </div>
  <div class="card col-6 offset-3 show-card listing-card">
    <img src="<%= listing.image.url %>" class="card-img-top show-img" alt="listing_imge" />
    <div class="card-body">
      <p class="card-text">Owned by <i><%= listing.owner.username %></i></p>
      <br />
      <p class="card-text"><%= listing.description %></p>

      <p class="card-text">
        <span class="price-no-tax">&#8377; <%= listing.price.toLocaleString("en-IN") %></span>
        <span class="price-with-tax d-none">&#8377; <%= Math.round(listing.price * 1.18).toLocaleString("en-IN") %> <i>(incl. 18% GST)</i></span>
      </p>

      <p class="card-text"><%= listing.location %></p>
      <p class="card-text"><%= listing.country %></p>
    </div>
  </div>
  <!-- ...rest of your show.ejs -->
</div>

<!-- Add GST toggle on show page -->
<div class="tax-toggle mt-3 col-6 offset-3">
  <div class="form-check-reverse form-switch">
    <input class="form-check-input" type="checkbox" role="switch" id="switchCheckDefaultShow" />
    <label class="form-check-label" for="switchCheckDefaultShow">Display total after taxes</label>
  </div>
</div>

<script>
  const taxSwitchShow = document.getElementById("switchCheckDefaultShow");
  taxSwitchShow.addEventListener("change", () => {
    const noTaxPrice = document.querySelector(".price-no-tax");
    const withTaxPrice = document.querySelector(".price-with-tax");

    if (taxSwitchShow.checked) {
      noTaxPrice.classList.add("d-none");
      withTaxPrice.classList.remove("d-none");
    } else {
      noTaxPrice.classList.remove("d-none");
      withTaxPrice.classList.add("d-none");
    }
  });
</script>

<script src="/js/map.js"></script>

<p>Map Token: <%= process.env.MAP_TOKEN ? "Loaded" : "Missing" %></p>
